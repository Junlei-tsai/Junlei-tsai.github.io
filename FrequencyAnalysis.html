<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>資訊安全與網路系統安全</title>

    <!-- Google Font: Source Sans Pro -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="plugins/fontawesome-free/css/all.min.css">
    <!-- Ionicons -->
    <link rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <!-- Tempusdominus Bootstrap 4 -->
    <link rel="stylesheet" href="plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
    <!-- iCheck -->
    <link rel="stylesheet" href="plugins/icheck-bootstrap/icheck-bootstrap.min.css">
    <!-- JQVMap -->
    <link rel="stylesheet" href="plugins/jqvmap/jqvmap.min.css">
    <!-- Theme style -->
    <link rel="stylesheet" href="dist/css/adminlte.min.css">
    <!-- overlayScrollbars -->
    <link rel="stylesheet" href="plugins/overlayScrollbars/css/OverlayScrollbars.min.css">
    <!-- Daterange picker -->
    <link rel="stylesheet" href="plugins/daterangepicker/daterangepicker.css">
    <!-- summernote -->
    <link rel="stylesheet" href="plugins/summernote/summernote-bs4.min.css">
    <!-- CodeMirror -->
    <link rel="stylesheet" href="plugins/codemirror/codemirror.css">
    <link rel="stylesheet" href="plugins/codemirror/theme/monokai.css">

    <style>
        .highlight {
            background-color: yellow;
        }

        .hover-table {
            margin-top: 20px;
            border-collapse: collapse;
            width: 100%;
        }

            .hover-table th, .hover-table td {
                border: 1px solid black;
                padding: 8px;
                text-align: center;
            }

            .hover-table th {
                background-color: #f2f2f2;
            }

            .hover-table td:hover {
                background-color: #f5f5f5;
                cursor: pointer;
                text-decoration: underline;
            }

      table3 {
        border-collapse: collapse;
        width: 100%;
      }

      th, td {
        border: 1px solid black;
        padding: 8px;
        text-align: center;
        width: 50px; /* 固定欄寬 */
      }

      .highlight {
        background-color: yellow;
      }
    </style>
</head>
<body class="hold-transition sidebar-mini layout-fixed">
    <div class="wrapper">
        <!-- Navbar -->
        <nav class="main-header navbar navbar-expand navbar-white navbar-light">
            <!-- Left navbar links -->
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" data-widget="pushmenu" href="#" role="button"><i class="fas fa-bars"></i></a>
                </li>
                <li class="nav-item d-none d-sm-inline-block">
                    <a onclick="ClickPAGE1();" class="nav-link">頻率分析 – 破解長文的方法</a>
                </li>
                <li class="nav-item d-none d-sm-inline-block">
                    <a onclick="ClickPAGE2();" class="nav-link">頻率分析 – 實作頻率分析 (由已知明文推論)</a>
                </li>
            </ul>
        </nav>
        <!-- /.navbar -->
        <!-- Main Sidebar Container -->
        <aside class="main-sidebar sidebar-dark-primary elevation-4">
            <!-- Brand Logo -->
            <a href="index3.html" class="brand-link">
                <img src="dist/img/AdminLTELogo.png" alt="AdminLTE Logo" class="brand-image img-circle elevation-3" style="opacity: .8">
                <span class="brand-text font-weight-light">AdminLTE 3</span>
            </a>

            <!-- Sidebar -->
            <div class="sidebar">

                <!-- Sidebar Menu -->
                <nav class="mt-2">
                    <ul class="nav nav-pills nav-sidebar flex-column" data-widget="treeview" role="menu" data-accordion="false">
                        <!-- Add icons to the links using the .nav-icon class  with font-awesome or any other icon font library -->
                        <li class="nav-item menu-open">
                            <a href="#" class="nav-link active">
                                <i class="nav-icon fas fa-tachometer-alt"></i>
                                <p>
                                    古典密碼學
                                    <i class="right fas fa-angle-left"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item">
                                    <a href="./SubstitutionCipher.html" class="nav-link">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>替換式密碼</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="./BruteForceCracking.html" class="nav-link">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>暴力破解法</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="./FrequencyAnalysis.html" class="nav-link active">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>頻率分析</p>
                                    </a>
                                </li>
                            </ul>
                        </li>
                        <!--<li class="nav-item menu-open">
                            <a href="#" class="nav-link active">
                                <i class="nav-icon fas fa-tachometer-alt"></i>
                                <p>
                                    現代密碼學
                                    <i class="right fas fa-angle-left"></i>
                                </p>
                            </a>
                            <ul class="nav nav-treeview">
                                <li class="nav-item">
                                    <a href="./index.html" class="nav-link active">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>對稱式加密</p>
                                    </a>
                                </li>
                                <li class="nav-item">
                                    <a href="./index2.html" class="nav-link">
                                        <i class="far fa-circle nav-icon"></i>
                                        <p>非對稱式加密</p>
                                    </a>
                                </li>
                            </ul>
                        </li>-->
                    </ul>
                </nav>
                <!-- /.sidebar-menu -->
            </div>
            <!-- /.sidebar -->
        </aside>

        <!-- Content Wrapper. Contains page content -->
        <div class="content-wrapper">
            <!-- Content Header (Page header) -->
            <div class="content-header">
                <div class="container-fluid">
                    <div class="row mb-2">
                        <div class="col-sm-6">
                            <h1 id="PAGE1_title" class="m-0">頻率分析 – 破解長文的方法</h1>
                            <h1 id="PAGE2_title" class="m-0" hidden>頻率分析 – 實作頻率分析 (由已知明文推論)</h1>
                        </div><!-- /.col -->
                    </div><!-- /.row -->
                </div><!-- /.container-fluid -->
            </div>
            <!-- /.content-header -->
            <!-- Main content -->
            <section class="content">
                <div class="container-fluid">
                    <!-- Main row -->
                    <div class="row">
                        <!-- Left col -->
                        <section id="PAGE1_section" class="col-lg-12 connectedSortable">

                            <div class="col-lg-12">
                                <span>
                                    我們說，透過字詞出現的頻率來分析密文，稱為頻率分析，根據常見的有字典頻率分析的三原則，我們可以推導為明文。
                                </span>
                            </div>
                            <br />
                            <div class="col-lg-12">
                                <span>前五名常出現的字母：e, t, a, o, i、最常出現的單字：the, to, of, and、常見的雙字母組合：st, ng, th, qu</span>
                            </div>
                            <br />
                            <div class="col-lg-2 col-sm-3">
                                <input class="btn btn-block btn-default btn-sm" type="button" value="點我切換明文" onclick="SwitchPlain();" />
                            </div>
                            <br />
                            <div class="col-lg-7">
                                <textarea id="txtarea_plain1" class="form-control" rows="15" readonly>
Once, there was a young boy. This boy had problems controlling his anger. When he got angry, he would say the first thing the samethat came to mind, even if it affected people.

One day, his father gifted him a hammer and a bundle of nails, then said, “Whenever you get mad, hammer a nail into the backyard fence.”

The boy used up half of his nails in the first few days. Over the following weeks, he used up fewer nails until his temper was under control. The father then asked the young boy to remove a nail for each day he didn’t lose his temper.

On the day when the boy had removed his last nail, his father told him, “You have done good, boy. But can you see the holes in the wall? The fence is never going to be . Likewise, when you say mean things in anger, you’ll leave a scar.”
</textarea>
                                <textarea id="txtarea_plain2" class="form-control" rows="15" readonly hidden>
There once was a poor boy who spent his days going door to door selling newspapers to pay for school. The poor boy was starving, so he began to ask for nourishment at each home he stopped at.

The poor boy was denied every time until he reached the door of a young girl. He asked for a glass of water, but seeing his poor state, the girl returned with a glass of milk. The boy asked how much he owed her for the milk, but she refused payment.

Years later, the girl, who was now a grown woman, fell sick. She went from doctor to doctor, but no one could cure her. Finally, she went to the best doctor in town.

The doctor spent months treating her until she was finally cured. Despite her happiness, she was afraid she couldn’t afford to pay the bill. But, when the hospital handed her the bill, it read, “Paid in full, with a glass of milk.”
</textarea>
                                <textarea id="txtarea_plain3" class="form-control" rows="15" readonly hidden>
One bright autumn day, a family of ants was busy working in the warm sunshine. They were drying out the grain they had stored up during the summer when a starving grasshopper came up. With his fiddle under his arm, the grasshopper humbly begged for a bite to eat.

“What!” cried the ants, “Haven’t you stored any food away for the winter? What in the world were you doing all summer?”

“I didn’t have time to store any food before winter,” the grasshopper whined. “I was so busy making music that the summer flew by.”

The ants simply shrugged and said, “Making music, were you? Very well, now dance!” The ants then turned their backs on the grasshopper and returned to work.
</textarea>
                            </div>

                            <div class="col-lg-7">
                                <div class="card-body">
                                    <div class="chart">
                                        <canvas id="barChart1" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;"></canvas>
                                        <canvas id="barChart2" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;" hidden></canvas>
                                        <canvas id="barChart3" style="min-height: 250px; height: 250px; max-height: 250px; max-width: 100%;" hidden></canvas>
                                    </div>

                                </div>
                            </div>
                        </section>

                        <section id="PAGE2_section" class="col-lg-12 connectedSortable" hidden>
                            <div>
                                <span>
                                    邪惡的駭客總是從經驗中累積自己的破解實力，這次他知道了暴力破解法很耗時，決定採用頻率分析。現在駭客已取得上下段的明文，卻未料到中間卻使用替換式加密，肉眼看不出來。他決定透過頻率分析，依序下列步驟破解密文。<br />
                                    STEP 1. 於是駭客把「密文前後段的明文」做單字頻率分析，得出「表一、部分明文單字頻率」 。<br />
                                    STEP 2. 將「表二、字典字母頻率」與「表三、密文字母頻率」進行對照，並依據「表一、部分明文單字頻率」 推論密文中重複出現的單字，在「表四」將加密段落回推明文。

                                </span>
                            </div>
                            <br>
                            <div class="row">

                                <div class="col-lg-5">
                                    <span>文章</span>
                                    <br>
                                    Once upon a time, a farmer had a goose that laid one golden egg every day. The egg provided enough money for the farmer and his wife to support their daily needs. The farmer and his wife continued to be happy for a long time. But, one day, the farmer thought, “Why should we take just one egg a day? Why can’t we take them all at once and make a lot of money?” The farmer told his wife his idea, and she foolishly agreed.
                                    <br><br>
                                    PHEF, PHE FEAP CLK, LB PHE GOOBE WLIC IPB GOWCEF EGG, PHE YLTUET DLB SZIVJ DIPH L BHLTN JFIYE. HE JIWWEC PHE GOOBE LFC VZP IPB BPOULVH ONEF, HONIFG PO YIFC LWW IPB GOWCEF EGGB. MZP LB HE ONEFEC PHE BPOULVH, HE OFWK YOZFC GZPB LFC MWOOC.PHE YLTUET SZIVJWK TELWIQEC HIB YOOWIBH UIBPLJE LFC NTOVEECEC PO VTK OXET HIB WOBP TEBOZTVE.
                                    <br><br>
                                    As the days went on, the farmer and his wife became poorer and poorer because of their foolishness.
                                </div>
                                <div class="col-lg-5">
                                    <span>明文</span>
                                    <div id="text">
                                        Once upon a time, a farmer had a goose that laid one golden egg every day. The egg provided enough money for the farmer and his wife to support their daily needs. The farmer and his wife continued to be happy for a long time. But, one day, the farmer thought, “Why should we take just one egg a day? Why can’t we take them all at once and make a lot of money?” The farmer told his wife his idea, and she foolishly agreed.
                                        <br><br>
                                        As the days went on, the farmer and his wife became poorer and poorer because of their foolishness.
                                    </div>
                                    <br>
                                    <span>密文</span>
                                    <div>
                                        PHEF, PHE FEAP CLK, LB PHE GOOBE WLIC IPB GOWCEF EGG, PHE YLTUET DLB SZIVJ DIPH L BHLTN JFIYE. HE JIWWEC PHE GOOBE LFC VZP IPB BPOULVH ONEF, HONIFG PO YIFC LWW IPB GOWCEF EGGB. MZP LB HE ONEFEC PHE BPOULVH, HE OFWK YOZFC GZPB LFC MWOOC.PHE YLTUET SZIVJWK TELWIQEC HIB YOOWIBH UIBPLJE LFC NTOVEECEC PO VTK OXET HIB WOBP TEBOZTVE.
                                    </div>
                                </div>

                            </div>
                            <span>表一、明文單字頻率 (前10個)</span>
                            <table id="wordTable" class="hover-table"></table>
                            <br>
                            <span>表二、字典字母頻率</span>
                            <table class="table table2" border="1" id="Table2"></table>
                            <br>
                            <span>表三、密文字母頻率</span>
                            <table class="table table2" border="1" id="Table3"></table>
                            <br>
                        </section>

                        <!-- /.Left col -->
                    </div>
                    <!-- /.row (main row) -->
                </div><!-- /.container-fluid -->
            </section>
            <!-- /.content -->
        </div>

        <aside class="control-sidebar control-sidebar-dark">
            <!-- Control sidebar content goes here -->
        </aside>
        <!-- /.control-sidebar -->
    </div>
    <!-- ./wrapper -->
    <!-- jQuery -->
    <script src="plugins/jquery/jquery.min.js"></script>
    <!-- jQuery UI 1.11.4 -->
    <script src="plugins/jquery-ui/jquery-ui.min.js"></script>
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <script>
        $.widget.bridge('uibutton', $.ui.button)
    </script>
    <!-- Bootstrap 4 -->
    <script src="plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- ChartJS -->
    <script src="plugins/chart.js/Chart.min.js"></script>
    <!-- Sparkline -->
    <script src="plugins/sparklines/sparkline.js"></script>
    <!-- JQVMap -->
    <script src="plugins/jqvmap/jquery.vmap.min.js"></script>
    <script src="plugins/jqvmap/maps/jquery.vmap.usa.js"></script>
    <!-- jQuery Knob Chart -->
    <script src="plugins/jquery-knob/jquery.knob.min.js"></script>
    <!-- daterangepicker -->
    <script src="plugins/moment/moment.min.js"></script>
    <script src="plugins/daterangepicker/daterangepicker.js"></script>
    <!-- Tempusdominus Bootstrap 4 -->
    <script src="plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js"></script>
    <!-- Summernote -->
    <script src="plugins/summernote/summernote-bs4.min.js"></script>
    <!-- overlayScrollbars -->
    <script src="plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script>
    <!-- AdminLTE App -->
    <script src="dist/js/adminlte.js"></script>
    <!-- AdminLTE for demo purposes -->
    <!--<script src="dist/js/demo.js"></script>-->
    <!-- AdminLTE dashboard demo (This is only for demo purposes) -->
    <script src="dist/js/pages/dashboard.js"></script>
    <!-- CodeMirror -->
    <script src="plugins/codemirror/codemirror.js"></script>
    <script src="plugins/codemirror/mode/css/css.js"></script>
    <script src="plugins/codemirror/mode/xml/xml.js"></script>
    <script src="plugins/codemirror/mode/htmlmixed/htmlmixed.js"></script>
</body>
</html>

<script type="text/javascript">
    // 畫面切換
    var PAGE1_title, PAGE1_section, PAGE2_title, PAGE2_section, data_article;
    var areaChartData, barChartCanvas, barChartData, temp0, temp1, barChartOptions;
    data_article = [
        14.1, 7.3, 8.2, 7.2, 6.2, 7.3, 5.5, 8.0, 4.3, 4.2,
        4.5, 1.8, 2.7, 2.7, 2.2, 3.0, 2.5, 3.5, 1.2, 1.8,
        1.3, 0.7, 0.0, 0.0, 0.0, 0.0
    ];
    BARCHART();
    function setTitleAndSection() {
        PAGE1_title = document.getElementById("PAGE1_title");
        PAGE1_section = document.getElementById("PAGE1_section");
        PAGE2_title = document.getElementById("PAGE2_title");
        PAGE2_section = document.getElementById("PAGE2_section");
    }

    function ClickPAGE1() {
        setTitleAndSection();
        PAGE1_title.hidden = false;
        PAGE1_section.hidden = false;
        PAGE2_title.hidden = true;
        PAGE2_section.hidden = true;
    }

    function ClickPAGE2() {
        setTitleAndSection();
        PAGE1_title.hidden = true;
        PAGE1_section.hidden = true;
        PAGE2_title.hidden = false;
        PAGE2_section.hidden = false;
    }

    // 切換明文
    function SwitchPlain() {
        var random = Math.floor(Math.random() * 3) + 1;

        for (i = 1; i <= 3; i++) {
            var txtarea_plainID = "txtarea_plain" + i;
            var txtarea_plain = document.getElementById(txtarea_plainID);
            if (i == random) {
                txtarea_plain.hidden = false;
                continue;
            }
            txtarea_plain.hidden = true;
        }

        if (random == 2) {
            data_article = [
                11.7, 8.6, 6.9, 10, 5.1, 5.4, 6.9, 7.3, 6.6, 4.2,
                4.6, 2.2, 2.5, 1.7, 3.2, 2.6, 2.3, 2, 2.8, 1.9,
                0.3, 1.1, 0, 0, 0, 0
            ];
        } else if (random == 3) {
            data_article = [
                11.3, 8.5, 7.7, 5.8, 6, 6.7, 6.5, 6.7, 7.7, 4.8,
                1.9, 1.2, 4.2, 3.5, 3.8, 1.7, 3.3, 3.3, 2.1, 1.7,
                0.8, 1, 0, 0, 0, 0
            ];
        } else {
            data_article = [
                14.1, 7.3, 8.2, 7.2, 6.2, 7.3, 5.5, 8.0, 4.3, 4.2,
                4.5, 1.8, 2.7, 2.7, 2.2, 3.0, 2.5, 3.5, 1.2, 1.8,
                1.3, 0.7, 0.0, 0.0, 0.0, 0.0
            ]
        }

        for (i = 1; i <= 3; i++) {
            var barChart_ID = "barChart" + i;
            var barChart = document.getElementById(barChart_ID);
            if (i == random) {
                barChart.hidden = false;
                continue;
            }
            barChart.hidden = true;
        }
        BARCHART(random);
    }

    //-------------
    //- BAR CHART -
    //-------------
    function BARCHART(ID = 1) {
        areaChartData = {
            labels: ['E', 'T', 'A', 'O', 'I', 'N', 'S', 'H', 'R', 'D', 'L', 'C', 'U', 'M', 'W', 'F', 'G', 'Y', 'P', 'B', 'V', 'K', 'J', 'X', 'Q', 'Z'],
            datasets: [
                {
                    label: '字典的字母頻率百分比',
                    backgroundColor: 'rgba(60,141,188,0.9)',
                    borderColor: 'rgba(60,141,188,0.8)',
                    pointRadius: false,
                    pointColor: '#3b8bba',
                    pointStrokeColor: 'rgba(60,141,188,1)',
                    pointHighlightFill: '#fff',
                    pointHighlightStroke: 'rgba(60,141,188,1)',
                    data: [
                        12.7, 9.1, 8.2, 7.5, 7.0, 6.7, 6.3, 6.1, 6.0, 4.3, 4.0,
                        2.8, 2.8, 2.4, 2.4, 2.2, 2.0, 2.0, 1.9, 1.5, 1.0, 0.8,
                        0.15, 0.15, 0.1, 0.07
                    ],
                },
                {
                    label: '文章的字母頻率百分比',
                    backgroundColor: 'rgba(210, 214, 222, 1)',
                    borderColor: 'rgba(210, 214, 222, 1)',
                    pointRadius: false,
                    pointColor: 'rgba(210, 214, 222, 1)',
                    pointStrokeColor: '#c1c7d1',
                    pointHighlightFill: '#fff',
                    pointHighlightStroke: 'rgba(220,220,220,1)',
                    data: data_article
                },
            ]
        }
        var showID = "#barChart" + ID;
        barChartCanvas = $(showID).get(0).getContext('2d')
        barChartData = $.extend(true, {}, areaChartData)
        temp0 = areaChartData.datasets[0]
        temp1 = areaChartData.datasets[1]
        barChartData.datasets[0] = temp1
        barChartData.datasets[1] = temp0

        barChartOptions = {
            responsive: true,
            maintainAspectRatio: false,
            datasetFill: false
        }

        new Chart(barChartCanvas, {
            type: 'bar',
            data: barChartData,
            options: barChartOptions
        })
    }



    //-------------
    //- 表一 -
    //-------------
    const textElement = document.getElementById('text');
    const wordTable = document.getElementById('wordTable');
    const wordCounts = {};

    // Function to remove <br> tags and normalize text
    const normalizeText = text => {
        return text.toLowerCase().replace(/[.,!?“”‘’]/g, '').replace(/<br\s*\/?>/g, '').trim();
    };

    // Get the normalized text content without <br> tags
    const normalizedText = normalizeText(textElement.innerHTML);

    // Split text into words and count occurrences
    const words = normalizedText.split(/\s+/);
    words.forEach(word => {
        if (wordCounts[word]) {
            wordCounts[word]++;
        } else {
            wordCounts[word] = 1;
        }
    });
    console.log(words)

    // Sort words by frequency and take the top 10
    const sortedWords = Object.entries(wordCounts).sort((a, b) => b[1] - a[1]).slice(0, 10);

    // Create table header and rows for the top 10 words
    const headerRow = document.createElement('tr');
    const countRow = document.createElement('tr');

    const wordHeader = document.createElement('th');
    wordHeader.innerText = '單字';
    headerRow.appendChild(wordHeader);

    const countHeader = document.createElement('th');
    countHeader.innerText = '計次';
    countRow.appendChild(countHeader);

    sortedWords.forEach(([word, count]) => {
        const wordCell = document.createElement('td');
        wordCell.innerText = word;
        headerRow.appendChild(wordCell);

        const countCell = document.createElement('td');
        countCell.innerText = count;
        countRow.appendChild(countCell);
    });

    wordTable.appendChild(headerRow);
    wordTable.appendChild(countRow);

    // Function to highlight words in text
    const highlightWords = word => {
        const regex = new RegExp(`\\b${word}\\b`, 'gi');
        textElement.innerHTML = textElement.innerHTML.replace(/<\/?span[^>]*>/g, ''); // Remove existing highlights
        textElement.innerHTML = textElement.innerHTML.replace(regex, match => `<span class="highlight">${match}</span>`);
    };

    // Add event listeners for hovering over the table words
    document.querySelectorAll('.hover-table td').forEach(cell => {
        const word = cell.innerText.split(' ')[0]; // Get the word part
        cell.addEventListener('mouseenter', () => highlightWords(word));
        cell.addEventListener('mouseleave', () => textElement.innerHTML = textElement.innerText.replace(/\n/g, '<br>')); // Remove highlights and keep line breaks
    });

    // Add event listeners for hovering over the text words
    const textWords = textElement.innerText.match(/\b\w+\b/g);
    textWords.forEach(word => {
        const regex = new RegExp(`\\b${word}\\b`, 'gi');
        textElement.innerHTML = textElement.innerHTML.replace(regex, match => `<span>${match}</span>`);
    });
    document.querySelectorAll('#text span').forEach(span => {
        span.addEventListener('mouseenter', () => highlightWords(span.innerText));
        span.addEventListener('mouseleave', () => textElement.innerHTML = textElement.innerText.replace(/\n/g, '<br>')); // Remove highlights and keep line breaks
    });

  //-------------
  //- 表二、三 -
  //-------------
  const englishAlphabet1 = ['字母','E', 'T', 'A', 'O', 'I', 'N', 'S', 'H', 'R', 'D', 'L', 'C', 'U', 'M', 'W', 'F', 'G', 'Y', 'P', 'B', 'V', 'K', 'J', 'X', 'Q', 'Z'];
  const englishAlphabet2 = ['百分比', 12.7, 9.1, 8.2, 7.5, 7.0, 6.7, 6.3, 6.1, 6.0, 4.3, 4.0, 2.8, 2.8, 2.4, 2.4, 2.2, 2.0, 2.0, 1.9, 1.5, 1.0, 0.8, 0.15, 0.15, 0.1, 0.07];

  var Table2 = document.getElementById("Table2");
  // Create rows
  const row01 = document.createElement('tr');
  const row02 = document.createElement('tr');
  // Populate rows with data
  englishAlphabet1.forEach((item, index) => {
    const cell = document.createElement('td');
    cell.textContent = item;
    cell.dataset.index = index;
    row01.appendChild(cell);
  });

  // Populate rows with data
  englishAlphabet2.forEach((item, index) => {
    const cell = document.createElement('td');
    cell.textContent = item;
    cell.dataset.index = index;
    row02.appendChild(cell);
  });

  Table2.appendChild(row01);
  Table2.appendChild(row02);

  const letters1 = ['字母', 'E', 'O', 'P', 'B', 'H', 'L', 'I', 'C', 'F', 'W', 'T', 'G', 'V', 'Z', 'Y', 'J', 'N', 'U', 'K', 'D', 'M', 'S', 'A', 'Q', 'X', 'R'];
  const letters2 = ['計次', 33, 23, 21, 19, 18, 17, 16, 15, 14, 13, 11, 10, 8, 7, 6, 5, 5, 5, 4, 2, 2, 2, 1, 1, 1, 0];
  const letters3 = ['百分比', 12.7, 8.9, 8.1, 7.3, 6.9, 6.6, 6.2, 5.8, 5.4, 5.0, 4.2, 3.9, 3.1, 2.7, 2.3, 1.9, 1.9, 1.9, 1.5, 0.8, 0.8, 0.8, 0.4, 0.4, 0.4, 0.0];

  var Table3 = document.getElementById("Table3");
  // Create rows
  const row1 = document.createElement('tr');
  const row2 = document.createElement('tr');
  const row3 = document.createElement('tr');

  // Populate rows with data
  letters1.forEach((item, index) => {
    const cell = document.createElement('td');
    cell.textContent = item;
    cell.dataset.index = index;
    row1.appendChild(cell);
  });

  letters2.forEach((item, index) => {
    const cell = document.createElement('td');
    cell.textContent = item;
    cell.dataset.index = index;
    row2.appendChild(cell);
  });

  letters3.forEach((item, index) => {
    const cell = document.createElement('td');
    cell.textContent = item;
    cell.dataset.index = index;
    row3.appendChild(cell);
  });

  // Append rows to table
  Table3.appendChild(row1);
  Table3.appendChild(row2);
  Table3.appendChild(row3);

  // Add event listeners for hover effect
  Table2.addEventListener('mouseover', (event) => {
    if (event.target.tagName === 'TD') {
      const index = event.target.dataset.index;
      document.querySelectorAll(`td[data-index='${index}']`).forEach(cell => {
        cell.classList.add('highlight');
      });
    }
  });

  Table2.addEventListener('mouseout', (event) => {
    if (event.target.tagName === 'TD') {
      const index = event.target.dataset.index;
      document.querySelectorAll(`td[data-index='${index}']`).forEach(cell => {
        cell.classList.remove('highlight');
      });
    }
  });

  // Add event listeners for hover effect
  Table3.addEventListener('mouseover', (event) => {
    if (event.target.tagName === 'TD') {
      const index = event.target.dataset.index;
      document.querySelectorAll(`td[data-index='${index}']`).forEach(cell => {
        cell.classList.add('highlight');
      });
    }
  });

  Table3.addEventListener('mouseout', (event) => {
    if (event.target.tagName === 'TD') {
      const index = event.target.dataset.index;
      document.querySelectorAll(`td[data-index='${index}']`).forEach(cell => {
        cell.classList.remove('highlight');
      });
    }
  });
</script>
